* Microsoft COBOL Version 4.5        L2.4 revision 002 04-May-21 18:35 Page   1
*                                       EX03.CBL
* Options: LIST(EX03.LST) ASMLIST(EX03.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EX03.
     3 AUTHOR.        GABRIEL FRANKLIN
     4                REBECCA M M MURAD
     5                WILLIAN KOHATSU.
     6 INSTALLATION.  HOME.
     7 DATE-WRITTEN.  27-04-2021.
     8 DATE-COMPILED. 04-May-21 18:35.
     9 SECURITY.      APENAS O AUTOR PODE MODIFICAR.
    10*REMARKS.       LER TODOS REGISTROS E ORDENAR CRESCENTE
    11*               SOMENTE IDADE MAIOR OU IGUAL A 18.
    12
    13 ENVIRONMENT DIVISION.
    14 CONFIGURATION SECTION.
    15    SOURCE-COMPUTER.   DELL-PC.
    16    OBJECT-COMPUTER.   DELL-PC.
    17    SPECIAL-NAMES.     DECIMAL-POINT IS COMMA.
    18
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21
    22    SELECT  CADENT  ASSIGN TO DISK
    23    ORGANIZATION  IS  LINE SEQUENTIAL.
    24
    25    SELECT  TRAB  ASSIGN  TO DISK.
    26
    27    SELECT  CADFESTA  ASSIGN TO DISK
    28    ORGANIZATION  IS  LINE SEQUENTIAL.
    29
    30 DATA DIVISION.
    31 FILE SECTION.
    32
    33 FD CADENT
    34    LABEL  RECORD ARE STANDARD
    35    VALUE OF FILE-ID IS "CADENT.DAT".
    36
    37 01 REG-ENT.
    38    02 NOME-ENT        PIC X(30).
    39    02 IDADE-ENT       PIC 9(02).
    40    02 RG-ENT          PIC X(10).
    41
    42 SD TRAB.
    43 01 REG-TRAB.
    44    02 NOME-TRAB    PIC X(30).
    45    02 IDADE-TRAB   PIC 9(02).
    46    02 RG-TRAB      PIC X(10).
    47
    48 FD CADFESTA
    49    LABEL RECORD ARE  STANDARD
    50    VALUE  OF FILE-ID IS "CADFESTA.DAT".
    51
    52 01 REG-SAI.
    53    02 NOME-SAI        PIC X(30).
    54    02 IDADE-SAI       PIC 9(02).
    55    02 RG-SAI          PIC X(10).
    56
    57 WORKING-STORAGE SECTION.
* Microsoft COBOL Version 4.5        L2.4 revision 002 04-May-21 18:35 Page   2
*                                       EX03.CBL
    58 77  FIM-ARQ           PIC X(03)   VALUE "NAO".
    59
    60 PROCEDURE  DIVISION.
    61
    62 EM03-EX02.
    63
    64 SORT    TRAB
    65    ASCENDING KEY  IDADE-TRAB
    66    INPUT  PROCEDURE  ROT-ENTRADA
    67    GIVING CADFESTA.
    68 STOP RUN.
    69
    70 ROT-ENTRADA SECTION.
    71    PERFORM  INICIO-ENTRADA.
    72    PERFORM  PRINCIPAL-ENTRADA
    73             UNTIL FIM-ARQ EQUAL "SIM".
    74    PERFORM  FIM-ENTRADA.
    75
    76 INICIO-ENTRADA SECTION.
    77    OPEN INPUT CADENT.
    78    PERFORM LEITURA-ENTRADA.
    79
    80 LEITURA-ENTRADA SECTION.
    81    READ CADENT
    82    AT END
    83    MOVE "SIM" TO FIM-ARQ.
    84
    85 PRINCIPAL-ENTRADA SECTION.
    86    PERFORM SELECAO-ENTRADA.
    87    PERFORM LEITURA-ENTRADA.
    88
    89 SELECAO-ENTRADA SECTION.
    90    IF IDADE-ENT  NOT LESS THAN 18
    91       PERFORM GRAVACAO-ENTRADA.
    92
    93 GRAVACAO-ENTRADA SECTION.
    94    MOVE  NOME-ENT   TO  NOME-TRAB.
    95    MOVE  IDADE-ENT  TO  IDADE-TRAB.
    96    MOVE  RG-ENT     TO  RG-TRAB.
    97    RELEASE  REG-TRAB.
    98
    99 FIM-ENTRADA SECTION.
   100    CLOSE CADENT.
   101
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1268     Code:         493     Dictionary:        1618
