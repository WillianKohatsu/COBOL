* Microsoft COBOL Version 4.5        L2.4 revision 002 11-May-21 21:48 Page   1
*                                       EX05.CBL
* Options: LIST(EX05.LST) ASMLIST(EX05.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EX05.
     3 AUTHOR.        GABRIEL FRANKLIN
     4                REBECCA M M MURAD
     5                WILLIAN KOHATSU.
     6 INSTALLATION.  HOME.
     7 DATE-WRITTEN.  04-05-2021.
     8 DATE-COMPILED. 11-May-21 21:48.
     9 SECURITY.      APENAS O AUTOR PODE MODIFICAR.
    10*REMARKS.       LER TODOS REGISTROS E ORDENAR CRESCENTE
    11*               POR ESTADO E CIDADE.
    12
    13 ENVIRONMENT DIVISION.
    14 CONFIGURATION SECTION.
    15    SOURCE-COMPUTER.   DELL-PC.
    16    OBJECT-COMPUTER.   DELL-PC.
    17    SPECIAL-NAMES.     DECIMAL-POINT IS COMMA.
    18
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21
    22    SELECT  CADENT  ASSIGN TO DISK
    23    ORGANIZATION  IS  LINE SEQUENTIAL.
    24
    25    SELECT  TRAB  ASSIGN  TO DISK.
    26
    27    SELECT  RELCURA  ASSIGN TO DISK.
    28
    29 DATA DIVISION.
    30 FILE SECTION.
    31
    32 FD CADENT
    33    LABEL  RECORD ARE STANDARD
    34    VALUE OF FILE-ID IS "CADENT.DAT".
    35
    36 01 REG-ENT.
    37    02 ESTADO-ENT       PIC X(02).
    38    02 CIDADE-ENT       PIC X(30).
    39    02 DATA-ENT.
    40       03 DIA-ENT       PIC 9(02).
    41       03 MES-ENT       PIC 9(02).
    42       03 ANO-ENT       PIC 9(04).
    43    02 CASOS-ENT        PIC 9(05).
    44    02 CURADOS-ENT      PIC 9(05).
    45
    46 SD TRAB.
    47 01 REG-TRAB.
    48    02 ESTADO-TRAB      PIC X(02).
    49    02 CIDADE-TRAB      PIC X(30).
    50    02 DATA-TRAB.
    51       03 DIA-TRAB      PIC 9(02).
    52       03 MES-TRAB      PIC 9(02).
    53       03 ANO-TRAB      PIC 9(04).
    54    02 CASOS-TRAB       PIC 9(05).
    55    02 CURADOS-TRAB     PIC 9(05).
    56
    57 FD RELCURA
* Microsoft COBOL Version 4.5        L2.4 revision 002 11-May-21 21:48 Page   2
*                                       EX05.CBL
    58    LABEL RECORD IS  OMITTED.
    59
    60 01 REG-ATR PIC X(80).
    61
    62 WORKING-STORAGE SECTION.
    63 77 FIM-ARQ            PIC X(03)    VALUE "NAO".
    64 77 CT-LIN             PIC 9(02)    VALUE 25.
    65 77 CT-PAG             PIC 9(02)    VALUE ZEROS.
    66 77 TOTAL-CASOS        PIC 9(10)    VALUE ZEROS.
    67 77 TOTAL-CURADOS      PIC 9(10)    VALUE ZEROS.
    68 77 CIDADE-CONTROL     PIC X(30)    VALUE SPACES.
    69 77 ESTADO-CONTROL     PIC X(02)    VALUE SPACES.
    70 77 ANO-RED            PIC 9(02)    VALUE ZEROS.
    71 77 AUX                PIC 9(05)    VALUE ZEROS.
    72
    73 01 JUMP-LINHA.
    74    02 FILLER          PIC X(80) VALUE SPACES.
    75
    76 01 CAB-01.
    77    02 FILLER          PIC X(13) VALUE SPACES.
    78    02 FILLER          PIC X(27) VALUE
    79       "RELACAO DE PESSOAS CURADAS ".
    80    02 FILLER          PIC X(17) VALUE
    81       "POR ESTADO/CIDADE".
    82    02 FILLER          PIC X(13) VALUE SPACES.
    83    02 FILLER          PIC X(05) VALUE "PAG. ".
    84    02 VAR-PAG         PIC  ZZ9.
    85    02 FILLER          PIC X(02) VALUE SPACES.
    86
    87 01 CAB-02.
    88    02 FILLER          PIC X(05) VALUE SPACES.
    89    02 FILLER          PIC X(08) VALUE "ESTADO: ".
    90    02 ESTADO-SAI      PIC X(02) VALUE SPACES.
    91    02 FILLER          PIC X(65) VALUE SPACES.
    92
    93 01 CAB-03.
    94    02 FILLER          PIC X(08)  VALUE SPACES.
    95    02 FILLER          PIC X(08)  VALUE "CIDADE: ".
    96    02 CIDADE-SAI      PIC X(30)  VALUE SPACES.
    97    02 FILLER          PIC X(34)  VALUE SPACES.
    98
    99 01 CAB-04.
   100    02 FILLER          PIC X(11)  VALUE SPACES.
   101    02 FILLER          PIC X(04)  VALUE "DATA".
   102    02 FILLER          PIC X(14)  VALUE SPACES.
   103    02 FILLER          PIC X(21)  VALUE
   104       "CASOS CONFIRMADOS".
   105    02 FILLER          PIC X(09)  VALUE SPACES.
   106    02 FILLER          PIC X(15)  VALUE
   107       "PESSOAS CURADAS".
   108    02 FILLER          PIC X(06)  VALUE SPACES.
   109
   110 01 ROD-01.
   111    02 FILLER          PIC X(05)  VALUE SPACES.
   112    02 FILLER          PIC X(28)  VALUE
   113       "TOTAL DE CASOS CONFIRMADOS: ".
   114    02 CASOS-RD        PIC ZZZZZZZZZ9.
   115    02 FILLER          PIC X(37)  VALUE SPACES.
* Microsoft COBOL Version 4.5        L2.4 revision 002 11-May-21 21:48 Page   3
*                                       EX05.CBL
   116
   117 01 ROD-02.
   118    02 FILLER          PIC X(05)  VALUE SPACES.
   119    02 FILLER          PIC X(26)  VALUE
   120       "TOTAL DE PESSOAS CURADAS: ".
   121    02 CURADOS-RD      PIC ZZZZZZZZZ9.
   122    02 FILLER          PIC X(39) VALUE SPACES.
   123
   124 01 DETALHE.
   125    02 FILLER           PIC X(09) VALUE SPACES.
   126    02 DIA-SAI          PIC 9(02).
   127    02 FILLER           PIC X(01) VALUE "/".
   128    02 MES-SAI          PIC 9(02).
   129    02 FILLER           PIC X(01) VALUE "/".
   130    02 ANO-SAI          PIC X(02).
   131    02 FILLER           PIC X(20) VALUE SPACES.
   132    02 CASOS-SAI        PIC ZZZZ9.
   133    02 FILLER           PIC X(22) VALUE SPACES.
   134    02 CURADOS-SAI      PIC ZZZZ9.
   135    02 FILLER           PIC X(11) VALUE SPACES.
   136
   137 PROCEDURE  DIVISION.
   138
   139 EM03-EX05.
   140
   141 SORT    TRAB
   142    ASCENDING  KEY  ESTADO-TRAB
   143    ASCENDING  KEY  CIDADE-TRAB
   144    ASCENDING  KEY  ANO-TRAB
   145    ASCENDING  KEY  MES-TRAB
   146    ASCENDING  KEY  DIA-TRAB
   147    USING      CADENT
   148    OUTPUT     PROCEDURE  ROT-SAIDA.
   149 STOP RUN.
   150
   151
   152 ROT-SAIDA SECTION.
   153    PERFORM  INICIO-SAIDA.
   154    PERFORM  PRINCIPAL-SAIDA
   155             UNTIL FIM-ARQ EQUAL "SIM".
   156    PERFORM  FIM-SAIDA.
   157
   158
   159 INICIO-SAIDA SECTION.
   160    OPEN OUTPUT RELCURA.
   161    PERFORM LEITURA-SAIDA.
   162    MOVE  ESTADO-TRAB  TO  ESTADO-CONTROL.
   163    MOVE  CIDADE-TRAB  TO  CIDADE-CONTROL.
   164
   165
   166 LEITURA-SAIDA SECTION.
   167    RETURN TRAB
   168    AT END
   169    MOVE "SIM" TO FIM-ARQ.
   170
   171
   172 PRINCIPAL-SAIDA SECTION.
   173    PERFORM IMPRESSAO-SAIDA.
* Microsoft COBOL Version 4.5        L2.4 revision 002 11-May-21 21:48 Page   4
*                                       EX05.CBL
   174    PERFORM LEITURA-SAIDA.
   175
   176
   177 IMPRESSAO-SAIDA SECTION.
   178    IF CT-LIN  GREATER THAN 19
   179       PERFORM  CABECALHO-SAIDA.
   180
   181    IF CIDADE-TRAB  NOT EQUAL TO  CIDADE-CONTROL
   182       PERFORM RODAPE-SAIDA
   183    ELSE IF  ESTADO-TRAB  NOT EQUAL TO  ESTADO-CONTROL
   184       PERFORM RODAPE-SAIDA
   185    ELSE
   186       PERFORM  IMPDET-SAIDA.
   187
   188
   189 IMPDET-SAIDA SECTION.
   190    DIVIDE  ANO-TRAB  BY  100
   191       GIVING AUX REMAINDER  ANO-RED.
   192
   193    ADD  CASOS-TRAB     TO  TOTAL-CASOS.
   194    ADD  CURADOS-TRAB   TO  TOTAL-CURADOS.
   195
   196    MOVE  DIA-TRAB     TO  DIA-SAI.
   197    MOVE  MES-TRAB     TO  MES-SAI.
   198    MOVE  ANO-RED      TO  ANO-SAI.
   199    MOVE  CASOS-TRAB   TO  CASOS-SAI.
   200    MOVE  CURADOS-TRAB TO  CURADOS-SAI.
   201
   202    WRITE  REG-ATR  FROM  DETALHE
   203       AFTER  ADVANCING  1  LINES.
   204    ADD  1   TO  CT-LIN.
   205
   206
   207 RODAPE-SAIDA SECTION.
   208    MOVE  TOTAL-CASOS  TO  CASOS-RD.
   209    MOVE  TOTAL-CURADOS TO  CURADOS-RD.
   210    MOVE  CIDADE-TRAB  TO  CIDADE-CONTROL.
   211    MOVE  ESTADO-TRAB  TO  ESTADO-CONTROL.
   212
   213    WRITE  REG-ATR  FROM  ROD-01
   214       AFTER ADVANCING     2 LINES.
   215    WRITE  REG-ATR  FROM  ROD-02
   216       AFTER ADVANCING  2 LINES.
   217
   218    MOVE  ZEROS  TO  TOTAL-CASOS.
   219    MOVE  ZEROS  TO  TOTAL-CURADOS.
   220
   221    PERFORM CABECALHO-SAIDA.
   222    PERFORM IMPDET-SAIDA.
   223
   224
   225 CABECALHO-SAIDA SECTION.
   226    MOVE  SPACES   TO  REG-ATR.
   227    ADD   1        TO  CT-PAG.
   228    MOVE  CT-PAG   TO  VAR-PAG.
   229
   230    MOVE  ESTADO-TRAB  TO  ESTADO-SAI.
   231    MOVE  CIDADE-TRAB  TO  CIDADE-SAI.
* Microsoft COBOL Version 4.5        L2.4 revision 002 11-May-21 21:48 Page   5
*                                       EX05.CBL
   232
   233    WRITE  REG-ATR
   234       AFTER  ADVANCING  PAGE.
   235    WRITE  REG-ATR  FROM  CAB-01
   236       AFTER  ADVANCING  2  LINES.
   237    WRITE  REG-ATR  FROM  CAB-02
   238       AFTER  ADVANCING  3  LINES.
   239    WRITE  REG-ATR  FROM  CAB-03
   240       AFTER  ADVANCING  2  LINE.
   241    WRITE  REG-ATR  FROM  CAB-04
   242       AFTER  ADVANCING  2  LINE.
   243    WRITE  REG-ATR  FROM JUMP-LINHA
   244       AFTER  ADVANCING  1  LINE.
   245
   246    MOVE  ZEROS  TO CT-LIN.
   247
   248
   249 FIM-SAIDA SECTION.
   250    MOVE  TOTAL-CASOS    TO  CASOS-RD.
   251    MOVE  TOTAL-CURADOS  TO  CURADOS-RD.
   252    WRITE  REG-ATR  FROM  ROD-01
   253       AFTER  ADVANCING  2  LINES.
   254    WRITE  REG-ATR  FROM  ROD-02
   255       AFTER  ADVANCING  2  LINES.
   256
   257    CLOSE RELCURA.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        2112     Code:        1156     Dictionary:        3193
